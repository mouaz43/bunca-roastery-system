<!-- views/partials/layout.ejs -->
<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title><%= (typeof pageTitle !== "undefined" && pageTitle) ? pageTitle : "Bunca Rösterei" %></title>

  <!-- One CSS only -->
  <link rel="stylesheet" href="/css/app.css?v=latte-1" />
  <script defer src="/js/app.js?v=latte-1"></script>
</head>

<body>
  <%
    const active = (typeof activeNav !== "undefined") ? activeNav : "";
    const title = (typeof pageTitle !== "undefined") ? pageTitle : "";
    const subtitle = (typeof pageSubtitle !== "undefined") ? pageSubtitle : "";
    const user = (typeof currentUser !== "undefined") ? currentUser : null;

    const primary = (typeof primaryAction !== "undefined") ? primaryAction : null;

    const hintT = (typeof hintTitle !== "undefined") ? hintTitle : "Seitenhinweis";
    const hintL = (typeof hintLines !== "undefined" && hintLines) ? hintLines : [];
  %>

  <div class="app">
    <aside class="sidebar" id="sidebar">
      <div class="brand">
        <div class="brand-left">
          <div class="brand-name">Bunca Rösterei</div>
          <div class="brand-sub">Produktions- und Bestellsystem</div>
        </div>
        <div class="brand-mark" aria-hidden="true"></div>
      </div>

      <nav class="nav">
        <a class="nav-link <%= active==='dashboard'?'is-active':'' %>" href="/dashboard">Dashboard</a>
        <a class="nav-link <%= active==='orders'?'is-active':'' %>" href="/orders">Bestellungen</a>
        <a class="nav-link <%= active==='production'?'is-active':'' %>" href="/production">Produktion</a>
        <a class="nav-link <%= active==='inventory'?'is-active':'' %>" href="/inventory">Lager</a>
        <a class="nav-link <%= active==='analytics'?'is-active':'' %>" href="/analytics">Analysen</a>
        <a class="nav-link <%= active==='settings'?'is-active':'' %>" href="/settings">Einstellungen</a>
        <a class="nav-link <%= active==='activity'?'is-active':'' %>" href="/activity">Aktivität</a>
      </nav>

      <div class="side-card">
        <% if (user) { %>
          <div class="meta-label">Eingeloggt als</div>
          <div class="meta-value"><%= user.name %></div>
          <div class="meta-sub">Rolle: <strong><%= user.role %></strong></div>

          <form method="POST" action="/logout" class="mt-3">
            <button class="btn btn-ghost w-full" type="submit">
              <span class="btn-icon" aria-hidden="true"></span>
              Abmelden
            </button>
          </form>
        <% } else { %>
          <div class="meta-label">Status</div>
          <div class="meta-value">Nicht eingeloggt</div>
        <% } %>
      </div>
    </aside>

    <main class="main">
      <header class="topbar">
        <button class="icon-btn" type="button" aria-label="Menü" data-toggle-sidebar>
          <span class="icon-lines" aria-hidden="true"></span>
        </button>

        <div class="topbar-title">
          <h1><%= title %></h1>
          <% if (subtitle) { %><p><%= subtitle %></p><% } %>
        </div>

        <div class="topbar-actions">
          <% if (primary && primary.href && primary.label) { %>
            <a class="btn btn-primary" href="<%= primary.href %>">
              <span class="btn-icon" aria-hidden="true"></span>
              <%= primary.label %>
            </a>
          <% } %>
        </div>
      </header>

      <section class="content">
        <%- body %>
      </section>

      <footer class="helper">
        <div class="helper-title"><%= hintT %></div>
        <div class="helper-body">
          <% if (hintL && hintL.length) { %>
            <% hintL.forEach(line => { %>
              <div class="helper-line"><%= line %></div>
            <% }) %>
          <% } else { %>
            <div class="helper-line">Hier sehen Sie die wichtigsten Informationen und Aktionen dieser Seite.</div>
          <% } %>
        </div>
      </footer>
    </main>
  </div>
</body>
</html>
